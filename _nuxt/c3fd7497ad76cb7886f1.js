(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{248:function(t,e,o){var content=o(258);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(53).default)("85f4b3ec",content,!0,{sourceMap:!1})},257:function(t,e,o){"use strict";var r=o(248);o.n(r).a},258:function(t,e,o){(e=o(52)(!1)).push([t.i,".step-button.forbid[data-v-52bcaf88]{cursor:not-allowed;opacity:.5}",""]),t.exports=e},260:function(t,e,o){"use strict";var r={props:{disabled:{type:Boolean,default:!1},to:{type:String,default:""},primary:{type:Boolean,default:!1}},computed:{buttonClass:function(){var t=[this.disabled?"forbid":"pointer"];return this.primary?t.push("white","bg-green"):t.push("green","bg-white"),t}},methods:{handleClick:function(t){!this.disabled&&this.to&&this.$router.push(this.to),this.$emit("click",t)}}},n=(o(257),o(42)),component=Object(n.a)(r,(function(){var t=this.$createElement;return(this._self._c||t)("button",{staticClass:"step-button ba br2 b--green ph3 pv2 tc w-100",class:this.buttonClass,attrs:{disabled:this.disabled},on:{click:this.handleClick}},[this._t("default")],2)}),[],!1,null,"52bcaf88",null);e.a=component.exports},262:function(t,e,o){"use strict";o.d(e,"a",(function(){return r}));var r={created:function(){this.$store.state.barcode||this.$router.push("/create-item/scan")}}},302:function(t,e,o){var content=o(387);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(53).default)("2253e4aa",content,!0,{sourceMap:!1})},303:function(t,e,o){var content=o(389);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(53).default)("7a78f5c7",content,!0,{sourceMap:!1})},386:function(t,e,o){"use strict";var r=o(302);o.n(r).a},387:function(t,e,o){(e=o(52)(!1)).push([t.i,".horizontal-step[data-v-31503aff]{max-height:calc(100vh - 1rem);height:calc(100vh - 1rem);flex-direction:column-reverse}.horizontal-step__content[data-v-31503aff]{padding:1rem 0}@media screen and (orientation:landscape){.horizontal-step[data-v-31503aff]{flex-direction:row}.horizontal-step.horizontal-step--right[data-v-31503aff]{flex-direction:row-reverse}.horizontal-step.horizontal-step--right .horizontal-step__content[data-v-31503aff]{padding:0 1rem 0 0}.horizontal-step__content[data-v-31503aff]{width:calc(100% - 10rem);padding:0 0 0 1rem}.horizontal-step__tail[data-v-31503aff]{width:10rem}}",""]),t.exports=e},388:function(t,e,o){"use strict";var r=o(303);o.n(r).a},389:function(t,e,o){(e=o(52)(!1)).push([t.i,".cover__photo[data-v-f8b3a660],.cover__video[data-v-f8b3a660]{min-height:10vh}.cover__video[data-v-f8b3a660]{max-height:30vh}.cover__result[data-v-f8b3a660]{transition:opacity .2s ease-in}.cover__major-action[data-v-f8b3a660]{margin:1.5rem 0}.cover__major-action button[data-v-f8b3a660],.cover__major-action label[data-v-f8b3a660]{height:4.5rem;width:4.5rem}@media screen and (orientation:portrait){.cover__tail[data-v-f8b3a660]{display:flex}.cover__tail .cover__step[data-v-f8b3a660]{width:50%}.cover__tail .cover__step[data-v-f8b3a660]:first-child{padding-right:.5rem}.cover__tail .cover__step[data-v-f8b3a660]:last-child{padding-left:.5rem}}@media screen and (orientation:landscape){.cover__photo[data-v-f8b3a660]{height:calc(100vh - 2rem)}.cover__video[data-v-f8b3a660]{max-height:calc(100vh - 2rem)}.cover__tail .cover__step[data-v-f8b3a660]:first-child{margin-bottom:.5rem}}",""]),t.exports=e},391:function(t,e,o){"use strict";o.r(e);o(109),o(55),o(35),o(26),o(65),o(158),o(66),o(54);var r=o(8),n=o(12),c=o(384),l=o.n(c),h=o(84),v=o(385),d=o.n(v),m=o(156),f=o(262),_={props:{isRightHand:{type:Boolean,default:!0}},data:function(){return{isLandscape:!1,rotationDetactor:null}},computed:{},created:function(){window&&(this.rotationDetactor=window.matchMedia("(orientation: landscape)"),this.isLandscape=!!this.rotationDetactor.matches,this.rotationDetactor.addListener(this.handleRotaionChanged))},beforeDestroy:function(){this.rotationDetactor.removeListener(this.handleRotaionChanged)},methods:{handleRotaionChanged:function(t){this.isLandscape=!!t.matches}}},w=(o(386),o(42)),C=Object(w.a)(_,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"horizontal-step w-100 flex justify-between",class:{"horizontal-step--right":t.isRightHand}},[o("div",{staticClass:"horizontal-step__tail flex flex-column justify-between"},[o("div",{directives:[{name:"show",rawName:"v-show",value:t.isLandscape,expression:"isLandscape"}],staticClass:"w-100"},[t._t("head")],2),o("div",{directives:[{name:"show",rawName:"v-show",value:t.isLandscape,expression:"isLandscape"}],staticClass:"w-100"},[t._t("action")],2),o("div",{staticClass:"w-100"},[t._t("tail")],2)]),o("div",{staticClass:"horizontal-step__content"},[t._t("default"),o("div",{directives:[{name:"show",rawName:"v-show",value:!t.isLandscape,expression:"!isLandscape"}],staticClass:"w-100"},[t._t("action")],2)],2),o("div",{directives:[{name:"show",rawName:"v-show",value:!t.isLandscape,expression:"!isLandscape"}],staticClass:"horizontal-step__head"},[t._t("head"),t._m(0)],2)])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"br2 white bg-orange pa2 mt2 tc"},[e("i",{staticClass:"fas fa-exclamation-triangle mr2"}),this._v("請將手機橫放，拍攝橫向照片 (◕﹏◕✿)")])}],!1,null,"31503aff",null).exports,S=o(260);function T(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(object);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,o)}return e}function k(t){return"true"===localStorage.getItem(t)}var x={components:{HorizontalStep:C,StepButton:S.a},mixins:[f.a],data:function(){return{camera:null,isTakingCover:!0,isRightHand:k("gcaa_hand_preference"),showCoverSample:!k("gcaa_has_cover_key"),showDetailSample:!k("gcaa_has_detail_key"),isTakingPhoto:!0,coverPhoto:"",detailPhoto:""}},computed:function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?T(Object(source),!0).forEach((function(e){Object(n.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):T(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({},Object(h.b)(["forceManual"]),{photoTakingIcon:function(){return this.isTakingPhoto?"fa-camera-retro":"fa-sync"},allowNext:function(){return this.isTakingCover?!!this.coverPhoto:!!this.detailPhoto},majorActionClass:function(){var t=[];return this.isTakingPhoto?(t.push("br-pill"),this.isShowingSample?t.push("bg-silver"):t.push("bg-red")):(t.push("br2"),this.isShowingSample?t.push("bg-silver"):t.push("bg-gold")),t},stepTitle:function(){return this.isTakingCover?{number:"➃",title:"拍攝產品正面"}:{number:"➄",title:"拍攝產品標籤"}},isShowingSample:function(){return this.isTakingCover&&this.showCoverSample||!this.isTakingCover&&this.showDetailSample},isShowingResult:function(){return!this.isTakingPhoto||this.isShowingSample},toggleSampleText:function(){return this.isTakingPhoto?this.isShowingSample?"開始拍照":"範例照片":this.isShowingSample?"目前照片":"範例照片"},photoStyle:function(){var img="";return img=this.isTakingCover?this.showCoverSample?"/imgs/sample_cover.jpg":this.coverPhoto:this.showDetailSample?"/imgs/sample_detail.jpg":this.detailPhoto,{backgroundImage:'url("'.concat(img,'")')}},nextStepText:function(){return this.isTakingCover?"下一步":"上傳資料"}}),mounted:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.forceManual){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.initCamera();case 4:case"end":return e.stop()}}),e)})))()},methods:{enableBrowserCamera:function(){var t=this;this.$store.commit(m.MUTATIONS.SET_MANUAL_MODE,!1),this.$nextTick((function(){t.initCamera()}))},initCamera:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.camera=new l.a(t.$refs.camera),e.prev=1,e.next=4,t.camera.startCamera(c.FACING_MODES.ENVIRONMENT,{width:1280});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),"NotFoundException"===e.t0.name||"NotAllowedError"===e.t0.name?(t.$store.commit(m.MUTATIONS.SET_MANUAL_MODE,!0),alert("我沒辦法打開相機，使用手動模式\n⊙﹏⊙")):console.error(e.t0);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})))()},getNativePhoto:function(t){var e=this,o=t.target.files[0];if(o&&o.type.match("image.*")){var r=new FileReader;r.onload=function(t){var o=t.target.result;e.isTakingCover?(e.coverPhoto=o,e.$store.commit(m.MUTATIONS.SET_COVER,o)):(e.detailPhoto=o,e.$store.commit(m.MUTATIONS.SET_DETAIL,o)),e.isTakingPhoto=!1},new d.a(o,{quality:.8,mimeType:"image/jpeg",width:1280,success:function(t){r.readAsDataURL(t)},error:function(t){console.error(t.message)}})}},clickMajor:function(){this.isShowingSample?this.toggleSample():this.isTakingPhoto?(this.takePhoto(),this.isTakingPhoto=!1):this.isTakingPhoto=!0},takePhoto:function(){var t={imageType:c.IMAGE_TYPES.JPG,imageCompression:.8},e=this.camera.getDataUri(t);this.isTakingCover?(this.coverPhoto=e,this.$store.commit(m.MUTATIONS.SET_COVER,e)):(this.detailPhoto=e,this.$store.commit(m.MUTATIONS.SET_DETAIL,e))},toggleSample:function(){this.isTakingCover?this.toggleCoverSample():this.toggleDetailSample()},switchHand:function(){this.isRightHand=!this.isRightHand,localStorage.setItem("gcaa_hand_preference",this.isRightHand)},toggleCoverSample:function(){this.showCoverSample=!this.showCoverSample,localStorage.setItem("gcaa_has_cover_key",!0)},toggleDetailSample:function(){this.showDetailSample=!this.showDetailSample,localStorage.setItem("gcaa_has_detail_key",!0)},prevStep:function(){this.isTakingCover?this.$router.push("/create-item/set-name-category"):(this.showCoverSample=!1,this.isTakingPhoto=!0,this.isTakingCover=!0)},nextStep:function(){this.isTakingCover?(this.isTakingPhoto=!0,this.isTakingCover=!1):this.$router.push("/create-item/done")}}},y=(o(388),Object(w.a)(x,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("horizontal-step",{staticClass:"cover pa3",attrs:{isRightHand:t.isRightHand}},[o("template",{slot:"head"},[o("div",{staticClass:"gray"},[t._v("第 "+t._s(t.stepTitle.number)+" 步")]),o("h1",{staticClass:"f3 mv0"},[t._v(t._s(t.stepTitle.title))]),o("div",{directives:[{name:"show",rawName:"v-show",value:!t.isTakingCover,expression:"!isTakingCover"}],staticClass:"mt2 f7 orange"},[t._v("請拍下可以明確辨識【製造商】資訊的照片")])]),o("div",{staticClass:"cover__photo w-100 relative flex items-center"},[t.forceManual?o("div",{staticClass:"cover__video absolute z-1 w-100 h-100 o-50 bg-light-gray flex flex-wrap items-center justify-center f4"},[t._v("請點旁邊的"),o("i",{staticClass:"fas fa-camera-retro mh2"}),t._v("開始拍照或"),o("button",{staticClass:"bg-light-yellow black ml2 ba b--black pointer br2 pv2 ph3 f5",on:{click:t.enableBrowserCamera}},[t._v("點此尋找相機")])]):o("video",{ref:"camera",staticClass:"cover__video w-100",class:{"o-50":t.isShowingResult,"o-100":!t.isShowingResult},attrs:{autoplay:"true"}}),o("div",{staticClass:"cover__result absolute top-0 left-0 w-100 h-100 contain bg-center bg-white",class:{"o-0":!t.isShowingResult,"o-100":t.isShowingResult,"z-2":t.isShowingResult},style:t.photoStyle},[o("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowingSample,expression:"isShowingSample"}],staticClass:"flex items-center justify-center white bg-black o-30 f3 h-100"},[t._v("範例圖片")])])]),o("template",{slot:"action"},[o("div",{staticClass:"cover__major-action flex items-stretch justify-center"},[t.forceManual&&this.isTakingPhoto&&!this.isShowingSample?o("div",[o("label",{staticClass:"dib white bw0 br2 f3 flex items-center justify-center pointer",class:t.majorActionClass,attrs:{for:"native-camera"}},[o("i",{staticClass:"fas",class:t.photoTakingIcon})]),o("input",{staticClass:"dn",attrs:{id:"native-camera",type:"file",accept:"image/*",capture:""},on:{change:t.getNativePhoto}})]):o("button",{staticClass:"white bw0 br2 f3",class:t.majorActionClass,on:{click:t.clickMajor}},[o("i",{staticClass:"fas",class:t.photoTakingIcon})]),o("div",{directives:[{name:"show",rawName:"v-show",value:t.allowNext&&!t.isTakingPhoto,expression:"allowNext && !isTakingPhoto"}],staticClass:"dib ml2"},[o("button",{directives:[{name:"show",rawName:"v-show",value:t.isTakingCover,expression:"isTakingCover"}],staticClass:"white bw0 br2 f4 cover__major-next h-100",class:t.majorActionClass,on:{click:t.nextStep}},[t._v(t._s(t.nextStepText))])])]),o("div",{staticClass:"cover__minor-action flex f6"},[o("div",{staticClass:"w-50 pr1"},[o("button",{staticClass:"mb2 ba silver b--silver bg-white pv1 ph2 w-100 br2 pointer",on:{click:t.switchHand}},[t._v("左右交換")])]),o("div",{staticClass:"w-50 pl1"},[o("button",{staticClass:"mb2 ba silver b--silver bg-white pv1 ph2 w-100 br2 pointer",on:{click:t.toggleSample}},[t._v(t._s(t.toggleSampleText))])])])]),o("div",{staticClass:"cover__tail",attrs:{slot:"tail"},slot:"tail"},[o("div",{staticClass:"cover__step"},[o("step-button",{on:{click:t.prevStep}},[t._v("上一步")])],1),o("div",{staticClass:"cover__step"},[o("step-button",{attrs:{primary:!0,disabled:!t.allowNext},on:{click:t.nextStep}},[t._v(t._s(t.nextStepText))])],1)])],2)}),[],!1,null,"f8b3a660",null));e.default=y.exports}}]);